install.packages("devtools")
devtools::install_github("rstudio/bookdown")
install.packages("devtools")
devtools::install_github("rstudio/bookdown")
bookdown:::serve_book()
unlink('index_cache', recursive = TRUE)
bookdown:::serve_book()
source('~/.active-rstudio-document', echo=TRUE)
library(hypothesisr)
dhcu_annotations <- hs_search_all( custom = list(uri.parts = "dhcu"))
dim(dhcu_annotations)
View(dhcu_annotations)
library(dplyr)
library(magrittr)
library(purrr)
dhcu_annotations2 <- read.csv("/Users/shawngraham/dhcu-teaching/annotations-to-oct15.csv")
dhcu_annotations2$text
dhcu_annotations2$user
dim(dhcu_annotations2)
library(readr)
list_cols <- map_lgl(dhcu_annotations2, ~is.list(.x))
dhcu_annotations2_nolist <- dhcu_annotations2[, !list_cols]
write_csv(dhcu_annotations2_nolist, "dhcu_annotations2.csv")
counts <- table(dhcu_annotations2_nolist$user)
library(ggplot2)
ggplot(as_data_frame(counts),
aes(reorder(Var1, n),
n)) +
geom_col() +
coord_flip() +
theme_bw()
library(tidytext)
library(tidyverse)
documents <- read_csv("dhcu_annotations2.csv")
word_counts <- documents %>%
group_by(user) %>%
unnest_tokens(word, text) %>%
count(user, word, sort = TRUE) %>%
ungroup()
custom_stop_words <- c(stop_words$word,
"craftingdigitalhistory.ca",
"https",
"github",
"http",
"gt",
"git",
"lt",
"1")
hist_words <- data_frame(word = custom_stop_words,
lexicon = c(stop_words$lexicon,
rep(NA, length(custom_stop_words) - length(stop_words$word))))
word_counts <- word_counts %>%
anti_join(hist_words)
word_counts
dtm <- word_counts %>%
cast_dtm(user, word, n)
library(topicmodels)
k <- 6
username_lda <- LDA(dtm, k = k, control = list(seed = 1234))
username_lda
username_lda_td <- tidy(username_lda)
username_lda_td
top_terms <- username_lda_td %>%
group_by(topic) %>%
top_n(5, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms
library(ggplot2)
theme_set(theme_bw())
top_terms %>%
mutate(term = reorder(term, beta)) %>%
ggplot(aes(term, beta)) +
geom_bar(stat = "identity") +
facet_wrap(~ topic, scales = "free") +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1))
k <- 10
username_lda <- LDA(dtm, k = k, control = list(seed = 1234))
username_lda
username_lda_td <- tidy(username_lda)
username_lda_td
top_terms <- username_lda_td %>%
group_by(topic) %>%
top_n(5, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms
library(ggplot2)
theme_set(theme_bw())
top_terms %>%
mutate(term = reorder(term, beta)) %>%
ggplot(aes(term, beta)) +
geom_bar(stat = "identity") +
facet_wrap(~ topic, scales = "free") +
theme(axis.text.x = element_text(size = 8, angle = 90, hjust = 1))
tt_s <- word_counts %>%
inner_join(get_sentiments("afinn"), by = "word") %>%
group_by(word) %>%
summarize(occurences = n(),
contribution = sum(score))
tt_s
tt_s %>%
top_n(40, abs(contribution)) %>%
mutate(word = reorder(word, contribution)) %>%
ggplot(aes(word, contribution, fill = contribution > 0)) +
geom_col(show.legend = FALSE) +
coord_flip()
sentiment_messages <- word_counts %>%
inner_join(get_sentiments("afinn"), by = "word") %>%
group_by(user) %>%
summarize(sentiment = mean(score),
words = n()) %>%
ungroup() %>%
filter(words >= 5) # filters out messages that have fewer words than this that contribute to sentinment score
sentiment_messages %>%
arrange(desc(sentiment))
tf_idf <- word_counts %>%
bind_tf_idf(word, user, n) %>%
arrange(desc(tf_idf))
tf_idf
library(stringr)
tf_idf %>%
group_by(user) %>%
top_n(4, tf_idf) %>%
ungroup() %>%
mutate(word = reorder(word, tf_idf)) %>%
ggplot(aes(word, tf_idf, fill = user)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ user, scales = "free") +
ylab("tf-idf") +
coord_flip()
username_lda_gamma <- tidy(username_lda, matrix = "gamma")
username_lda_gamma %>%
left_join(documents, by = c('document' = 'user')) %>%
# get authors with at least ten documents
semi_join(., documents %>% count(user) %>% filter(n > 20),
by=  c('document' = 'user')) %>%
mutate(doc = 1:nrow(.)) %>%
ggplot(aes(doc, gamma, fill = as.character(topic))) +
geom_col() +
theme(axis.text.x = element_text(size = 10, angle = 90, hjust = 1)) +
facet_wrap( ~ document, scales = "free_y")
username_lda_gamma %>%
left_join(documents, by = c('document' = 'user')) %>%
# get authors with at least ten documents
semi_join(., documents %>% count(user) %>% filter(n > 5),
by=  c('document' = 'user')) %>%
mutate(doc = 1:nrow(.)) %>%
ggplot(aes(doc, gamma, fill = as.character(topic))) +
geom_col() +
theme(axis.text.x = element_text(size = 10, angle = 90, hjust = 1)) +
facet_wrap( ~ document, scales = "free_y")
username_lda_gamma %>%
left_join(documents, by = c('document' = 'user')) %>%
# get authors with at least ten documents
semi_join(., documents %>% count(user) %>% filter(n > 2),
by=  c('document' = 'user')) %>%
mutate(doc = 1:nrow(.)) %>%
ggplot(aes(doc, gamma, fill = as.character(topic))) +
geom_col() +
theme(axis.text.x = element_text(size = 10, angle = 90, hjust = 1)) +
facet_wrap( ~ document, scales = "free_y")
getwd()
install.packages("citr")
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
install.packages("xtable")
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
